АСТЕРОИДИ
=========

## За играта
АСТЕРОИДИ е едноставна игра во која целта е да се уништат одреден број астероиди пред истекување на времето. Минималниот број астероиди кои треба да се уништат зависи од нивото на тежина кое ќе го избере играчот. Дополнително, постои и можност да се натпреваруваат и два играча, со што победник е оној играч кој ќе уништи повеќе астероиди пред истекот на времето.
Инспирација за оваа игра беше класичната [Asteroids] игра на Atari од 1979.
Верзијата која јас ја изработив е проширена со можност за избор на ниво на тежина, избор  на вселенско летало и multiplayer опција

## Имплементација
За имплементација на играта се користат следниве класи: `Sprite`, `ImageInfo`, `Ship`, `Game` и `AdditionalFunctions`.

Астероидите, куршумите, анимацијата за експлозија на астероидите и пакетите за бонуси се објекти од класатa `Sprite` во која се чуваат информации за  позицијата, брзината на движење, аголот на ротација и брзината на ротирање, животниот век на објектот и информација за тоа дали е потребно сликата која го претставува објектот да биде анимирана (последните две информации се добиваат од класата `ImageInfo`). Во оваа класа има и методи за исцртување на објектите, нивно ажурирање и детекција на колизија меѓу два објекта.

Во класата `ImageInfo` се чуваат информации за сликите кои ги претставуваат различните објекти, поточно центарот на сликата, радиусот, димензиите, животниот век и дали има потреба од анимација на сликата.

Класата `Ship` чува податоци за вселенскиот брод, неговата позиција, брзината со која се движи, аголот на ротација и брзината на ротирање, слика со која е претставено леталото и слика која се прикажува кога се додава гас за забрзување. Подетален опис на класата и нејзините функционалности следуваат во продолжение.

Со следниов код, во конструкторот, се врши иницијализација на податоците кои се потребни за правилно прикажување и движење на леталото, односно неговата позиција на екранот (`Position`),  брзината  на движење (`Velocity`), информација дали се дава гас за забрзуавње (`Thrust`), аголот на ротација и брзината на ротирање (`Angle`, `AngleVelocity`), слики за двете состојби во кои може да се наоѓа вселенскиот брод (`ImageShip` и `ImageThrust`), центарот, димензиите и радиусот на сликите кои се добиваат од објект од класата `ImageInfo` , спомената претходно.

```c#
public float[] Position { get; private set; }
        public float[] Velocity { get; set; }
        public bool Thrust { get; set; }
        public float Angle { get; private set; }
        public float AngleVelocity { get; set; }
        public Bitmap ImageShip { get; private set; }
        public Bitmap ImageThrust { get; private set; }
        public int[] ImageCenter { get; private set; }
        public int[] ImageSize { get; private set; }
        public float Radius { get; private set; }

        public Ship(float[] pos, float[] vel, float angle, Bitmap image, Bitmap imageTh, ImageInfo info)
        {
            Position = pos;
            Velocity = vel;
            Thrust = false;
            Angle = angle;
            AngleVelocity = 0;
            ImageShip = image;
            ImageThrust = imageTh;
            ImageCenter = info.Center;
            ImageSize = info.Size;
            Radius = info.Radius;
        }
```
Методот `Draw()` има едноставна задача за исцртување на леталото, односно исцртување на соодветната слика, во зависност од состојбата во која се наоѓа леталото, на одредена позиција и ротирана за одреден агол.

```c#
public void Draw(Graphics g)
        {
            if (Thrust)
            {
                g.DrawImage(AdditionalFunctions.RotateImage(ImageThrust, Angle), Position[0], Position[1]);
            }
            else
            {
                g.DrawImage(AdditionalFunctions.RotateImage(ImageShip, Angle), Position[0], Position[1]);
            }

        }
```
Функцијата `RotateImage` е дел од класата `AdditionalFunctions` во која покрај овој метод, постојат и методи за претворање на агол во вектор, пресметка која е потребна за одредување на правецот на движење на леталото и куршумите додека леталото ротира и едноставен метод за одредување на растојание меѓу два објекта.

Следен метод во класата `Ship` е методот `Update()`. Овој метод заедно со претходниот метод `Draw()` се повикуваат од  класата на формата во која се одвива играњето при секое отчукување на тајмер.
```c#
public void Update()
        {
            Angle += AngleVelocity;
            Position[0] = (Position[0] + Velocity[0]) % Form1.WIDTH;
            Position[1] = (Position[1] + Velocity[1]) % Form1.HEIGHT;
            if (Thrust)
            {
                float[] acc = AdditionalFunctions.angleToVector((float)Math.PI / 180 * Angle);
                Velocity[0] += acc[0] * 0.1f;
                Velocity[1] += acc[1] * 0.1f;
            }

            Velocity[0] *= 0.99f;
            Velocity[1] *= 0.99f;
            if (Position[0] <= 0)
                Position[0] = Form1.WIDTH - 50;
            if (Position[1] <= 0)
                Position[1] = Form1.HEIGHT - 50;
        }
```
Овој метод врши ажурирање на ротацијата на леталото со зголемување на аголот за одредена брзина која се определуа со методите:

```c#
public void increment_ang_vel()
        {
            AngleVelocity += 2;
        }

        public void decrement_ang_vel()
        {
            AngleVelocity -= 2;
        } 
```
кои се повикуваат при притискање на соодветно копче на тастатурата. Дополнително се менува и позицијата на леталото соодветно на брзината со која се движи и притоа се внимава доколку излезе од некоја од границите на прозорецот да се појави на спротивната страна. Доколку се додава гас тогаш се пресметува и колкаво е забрзувањето и соодветно се ажурира брзината. `angleToVector` се повикува со `(float)Math.PI / 180 * Angle`, односно аголот од степени се претвора во радијани за да се претвори во вектор. Потоа се множи брзината со одреден фактор (0.99) со цел по одредено време, кога ќе се престане со додавање гас, леталото постепено да застане.

Последниот метод од класата `Ship` е методот `Shoot()` кој се повикува кога играчот пука.

```c#
public void Shoot(Bitmap image)
        {
            float[] forward = AdditionalFunctions.angleToVector((float)Math.PI / 180 * Angle);
            float[] missile_pos = new float[] { Position[0] + Radius, Position[1] + Radius};
            float[] missile_vel = new float[] { Velocity[0] + 6 * forward[0],Velocity[1] + 6 * forward[1]};
            if(image.Tag == "player1")
                Form1.TheGame.MissileGroup1.Add(new Sprite(missile_pos, missile_vel, Angle, 0, image, Form1.MissileInfo));
            else
                Form1.TheGame.MissileGroup2.Add(new Sprite(missile_pos, missile_vel, Angle, 0, image, Form1.MissileInfo));
        }
```
Во овој метод се одлучува кој од играчите пука и куршумите се додаваат во соодветната листа која се наоѓа во класата `Game`, а претходно се одредува правецот на движење на куршумите со методот `angleToVector` споменат погоре, нивната брзина и позиција.

Класата `Game` ги содржи сите информации потребни за играта, сликите, листите со куршуми, астероиди и пакети со бонуси за време и животи, имињата на играчите и сл. Има метод за одредување на минималниот број поени соодветно на нивото на тежина кои треба да се постигнат пред истекот на времето и метод за рестартирање на играта откако ќе заврши

## Изглед и упатство

![alt text](https://photos-4.dropbox.com/t/0/AADfuXoNSBIOzLXdbi5c8Gpy0yRs3xN2v6IGymyfFgPzOQ/12/189560432/png/1024x768/3/1399838400/0/2/Capture.PNG/nBsQHd3fK4I5JNJeTl9qyKKe28Pu2yKb-BpTiyGWXNM "Главно мени")
>Изглед на главното мени

![alt text](https://dl.dropbox.com/s/aed26i630cdk2cc/Capture1.PNG "Инструкции")
>Прозорец со инструкции

![alt text](https://dl-web.dropbox.com/get/Asteroidi/Capture3.PNG?_subject_uid=189560432&w=AABODZ49yGsXac6P8uQenpvhPFuvzB6U0iYj-B9IZw7keA "Нова игра")
>По притискање на копчето Нова игра се појавува прозорец во кој е потребно да се избере бројот на играчи, тежината на играта, името на играчот/играчите и вселенскиот брод. Со притискање на копчето Играј, играта започнува

![alt text](https://dl-web.dropbox.com/get/Asteroidi/Capture4.PNG?_subject_uid=189560432&w=AADJb_-KxAN9XsojZkoUhD4chJF0zZZS60lc4L2oMNuL2g "Игра со 2 играча")
>На сликата е прикажана игра на два играча од кои победник ќе биде оној кој ќе освои повеќе поени пред истекување на времето. Доколку тој со повеќе поени ги загуби животите пред да истече времето, тогаш победник е играчот кој останува. Повремено, на одреден број поени се појавуваат пакети кои оној кој што ќе ги собере добива еден живот или пак времето се зголемува за 5 секунди, во зависност од пакетот. Слично е и со еден играч, но таму играчот треба да уништи одреден број астероиди пред да истече времето. Контролите за управување на летала, како и информациите за каков вид бонус носат пакетите се наоѓаат во делот Инструкции, до кој се пристапува од главното мени на играта.

[asteroids]:http://atari.com/arcade#!/arcade/asteroids/play